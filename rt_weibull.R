#stan code
weibull_code <- 'data{
	int<lower=1> N;
	int<lower=1> NS;
	int<lower=1> NI;
	int<lower=1, upper=NS> subject[N];
	int<lower=1, upper=NI> item[N];
	vector[N] cond1;
	vector[N] cond2;
	vector<lower=0>[N] rt;
	vector[3] zero;
}

parameters{
	vector[3] beta;
	vector[3] u[NS];
	vector[3] w[NI]; 
	vector<lower=0>[3] sigma_u;
	vector<lower=0>[3] sigma_w;
	corr_matrix[3] omega_u;
	corr_matrix[3] omega_w;
	real<lower=0> shape;
}

transformed parameters{
	cov_matrix[3] Sigma_u;
	cov_matrix[3] Sigma_w;
	for(r in 1:3){
		for(c in 1:3){
			Sigma_u[r, c] <- sigma_u[r] * sigma_u[c] * omega_u[r, c];
			Sigma_w[r, c] <- sigma_w[r] * sigma_w[c] * omega_w[r, c];
		}
	}
}

model{
	vector<lower=0>[N] scale;
	for(j in 1:NS){
		u[j] ~ multi_normal(zero, Sigma_u);
	}
	for(k in 1:NI){
		w[k] ~ multi_normal(zero, Sigma_w);
	}
	sigma_u ~ gamma(1.5, 1.0E-4);
	sigma_w ~ gamma(1.5, 1.0E-4);
	shape ~ gamma(1, 0.001);
	for(i in 1:N){
		scale[i] <- exp(-((beta[1] + u[subject[i], 1] + w[item[i], 1]) +
			         	      (beta[2] + u[subject[i], 2] + w[item[i], 2])*cond1[i] + 
				     	        (beta[3] + u[subject[i], 3] + w[item[i], 3])*cond2[i])/shape);
	}
	rt ~ weibull(shape, scale);
}
'

#data
dat <-structure(list(N = 882L, NS = 42L, NI = 42L, zero = c(0, 0, 0), rt = c(430.063, 612, 692, 500.381, 321.102, 414.354, 474, 
482.668, 451, 440.848, 243.956, 292.396, 278.339, 317, 277.911, 460, 423.712, 271.637, 276.056, 272, 274.053, 355, 364, 222.499, 
447.449, 346, 558, 448, 368.902, 499.645, 512.392, 416.493, 433.304, 372, 395, 838.089, 222.759, 584.645, 388, 689.962, 333, 431, 
370.684, 348.459, 212.032, 620.507, 339.174, 354, 296, 271.742, 328, 409.54, 352.972, 619, 262.847, 270.04, 697, 497, 460.072, 
309.478, 272.614, 295.608, 375, 283.708, 457.167, 357, 413.134, 349, 292.529, 235.58, 413, 266.364, 597.687, 323.331, 532, 240.009, 
397, 365.471, 247.146, 330, 338.373, 412, 780, 397.909, 387.563,398.115, 468, 265.65, 336, 391.061, 358.542, 525.835, 384.613, 
484.453, 709, 379, 475.453, 429, 330.004, 307.008, 345.845, 1035, 394.572, 320, 257.523, 498, 246.231, 484.405, 391, 421, 226.319, 
334.591, 344, 311, 277.563, 536.489, 275.124, 267.551, 253.523, 335, 481.614, 264.594, 684, 328.946, 612, 465.839, 708, 391.416, 
819, 360.949, 316.135, 479.144, 444, 383.433, 432.491, 374, 492.103, 332, 416.87, 642, 367.823, 1007, 331.788, 312.55, 494.267, 364.062, 
548, 549, 354.954, 420, 726.454, 1151.498, 487.704, 902, 400.701, 620.177, 388, 504, 340.746, 274.168, 446.695, 790.829, 288.431, 
641.099, 263.007, 347, 328, 304, 558.005, 264, 278, 207.992, 294.585, 344, 331.53, 1620.652, 231.67, 382, 218, 311.264, 401.45, 
217, 496.488, 1291.086, 210.527, 169.214, 2053.681, 300, 382, 648.516, 245, 489.977, 568.083, 355, 222, 456.662, 1182.478, 
214, 211.532, 260.469, 249.541, 243, 232, 287, 298.539, 525.07, 428.888, 311.323, 203, 367.112, 1800.834, 310.575, 221, 560.844, 
376, 264.472, 302.038, 368.492, 1100.69, 404, 463.143, 460.944, 213, 1057, 211, 469.416, 228, 384, 493.061, 246.109, 236.038, 
278.475, 680.417, 343, 188, 228.417, 522.881, 313.118, 229, 561.885, 409, 230.548, 269.738, 248, 476.872, 349, 700.293, 443.654, 274, 
410.559, 215, 788.387, 1365.522, 458, 291.627, 237.844, 1494.762, 555.518, 263, 449.333, 234, 257.371, 512, 520.022, 246, 511.936, 
548.443, 211.784, 2169.034, 268.565, 245, 401, 573.021, 262.602, 419, 221.958, 349, 247, 2870.997, 663.378, 268.601, 401.041, 
188, 605.819, 229.782, 242.573, 337, 211, 907.905, 472.013, 342.93, 280.565, 287, 1017.527, 483, 495, 441.564, 276.008, 291, 407.223, 
350.247, 231, 183, 241.47, 251.647, 474.503, 791.358, 255.54, 418, 269, 468.195, 848, 814.541, 297, 338.534, 348, 298, 492.192, 
899.484, 614.391, 557.154, 375.849, 481.098, 645, 256.07, 447.821,367, 196, 210, 352.232, 393.613, 187, 304.587, 220.42, 573.091, 
308, 311, 464.616, 756.678, 501, 449.998, 322.523, 452.971, 826.848, 432, 348.035, 564.412, 548, 532.448, 241.547, 410, 299.576, 399, 
452.156, 228, 411.142, 329.882, 697.618, 226.576, 338, 495.077, 464, 541.093, 5400.063, 401, 303.622, 324.936, 326, 483.547, 
373.446, 395, 631.165, 370.372, 309.224, 548.934, 405, 463.251, 388, 479.968, 328, 315.074, 283.533, 917.074, 378, 514, 532.866, 
375, 517.815, 4730.877, 261.032, 340.659, 527.77, 419.498, 458, 408.066, 421, 330.586, 377, 389.365, 288.59, 406.942, 947, 415.114, 
355, 303, 278.273, 269.865, 353.519, 727, 369, 370.524, 685.645, 336.595, 567.055, 381, 537.88, 444.774, 324.438, 396, 380.544, 
304.987, 462.388, 382.986, 490.395, 250, 465, 420, 605.95, 347.034,327, 435.108, 671.061, 352, 365, 374.967, 391.894, 293.21, 365.023, 
519, 393.438, 514, 422.165, 363.085, 322.691, 457.646, 477, 303.191, 611.64, 274.01, 622, 407, 581.716, 270.909, 280.868, 457, 736.988, 
373, 321, 476.143, 264.554, 376.13, 1587.755, 433.689, 355.958, 214.68, 232, 212, 461, 312.425, 444, 340.48, 370.888, 340, 542.016, 
291, 435.385, 355.502, 476, 315.496, 381, 517.574, 391.974, 226,387, 362, 437.777, 631.943, 354.535, 800.066, 188, 372.138, 254.045, 
446.753, 854, 189, 404, 353.377, 538.412, 332, 335, 317.548, 319, 294.098, 423.292, 347.184, 463.497, 250.896, 200.541, 460, 
322, 228, 239.962, 312, 175, 419.263, 372.621, 316.026, 252, 237, 580.316, 483, 345.782, 248.992, 259, 330.961, 235.746, 253.045, 
169.968, 192, 486.518, 306, 258, 473.445, 191, 289.557, 482, 398, 206.52, 445.671, 412.413, 449, 201.103, 334.704, 202, 333, 
297.058, 380, 426.475, 642.18, 414.202, 237.081, 552, 211, 295.431, 252.559, 1159.062, 221, 292.283, 358, 276, 398.228, 289.365, 
248, 338, 451.509, 277.205, 187, 225, 478.969, 253.324, 348.092, 384.149, 355, 223, 271.125, 280, 160, 280.496, 653.35, 437.118, 
290, 236, 187, 246.975, 415.239, 362.447, 217, 431.666, 311.114, 312, 281, 395.27, 261.091, 314, 262.555, 260.493, 266.537, 474.913, 
444, 280, 473.982, 224, 399.119, 268, 193.165, 371, 434.556, 446.581, 355, 212, 282.271, 425.01, 233.582, 358, 215.303, 299, 
567.57, 240.698, 260.671, 285.445, 205, 432, 818.845, 279.836, 271.267, 229, 268.727, 598.266, 678.484, 363.976, 262, 237.493, 
746, 248.461, 208.203, 341, 239.517, 181, 649.352, 531.187, 352, 254.135, 292.183, 553, 497.765, 450, 231.488, 223.2, 270, 699.368, 
433.15, 281, 358.095, 395.093, 330, 273.616, 231.936, 464.241, 221.534, 337.05, 537, 647.529, 267, 273, 294.067, 220.957, 490.138, 
345.608, 420, 270, 221.128, 238, 237.649, 230.062, 374.384, 243, 774.561, 348.562, 216.029, 290.063, 873, 257.847, 328.14, 876.374, 
363, 603, 532.491, 370, 425.984, 667.503, 210.514, 682.096, 452, 260.997, 218, 486, 575.811, 226.28, 235.711, 825.477, 249, 272.56, 
317.169, 336, 271.548, 218.08, 373, 234.118, 219.079, 581.085, 240, 403.397, 232.336, 1328.117, 553.213, 537, 276, 649.528, 
351, 229, 1140.585, 568.798, 380.966, 343.301, 214, 594.659, 326.43, 218.201, 454, 237.589, 228.139, 552.951, 299.858, 272, 
353, 329, 346.861, 431, 342.971, 229.811, 272, 259.455, 243.327, 182, 250, 247.277, 296.875, 395.058, 353, 319.143, 303.836, 318, 
244, 221.67, 255.2, 282, 387.458, 424, 275.957, 427, 331, 582.243, 319.556, 318, 365.404, 215, 188.551, 294, 289.092, 242.107, 350.578, 
325.927, 269, 242, 210.144, 501, 198.064, 569.209, 222, 202.927, 386, 841.022, 212.537, 352, 287.236, 252, 278.771, 262, 329.102, 
344, 229.557, 321, 286, 267, 282.47, 277.471, 1724.42, 257.32, 245.324, 260.502, 342, 316, 432.502, 177, 247.484, 352, 224.443, 
441.321, 291, 326.494, 259, 203.463, 326, 366.14, 514.181, 348, 368.583, 213.424, 258, 549, 384.297, 315, 495.411, 288.684, 320, 
357.194, 242, 311.545, 320.758, 277.564, 295, 204.958, 211, 380.916, 317, 213, 262.526, 292.079, 307, 406.583, 376, 303.552, 237.07, 
406.021, 697.429, 246, 340, 554.83, 435.565, 443, 331, 499.217, 390.301, 339, 305.961, 269, 367.966, 220.595, 248, 506.688, 403, 
544.714, 379, 326.41, 306, 350, 269.249, 265.796, 297.145, 201.006,380, 642.112, 266, 290.658, 307, 388.785, 498.158, 251.284, 358, 
499.531, 312, 338), cond1 = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 
1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 
1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 
1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 
1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 
1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 
0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 
1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 
1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 
1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 
1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 
1, 1, 1, 0, 0, 0, 0, 0, 0, 0), cond2 = c(0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0,0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 
1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 
1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 
1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 
1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 
1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0), subject = c(3L, 4L, 6L, 1L, 5L, 8L, 2L, 7L, 2L, 3L, 5L, 1L, 7L, 4L, 8L, 6L, 3L, 7L, 
8L, 2L, 5L, 6L, 4L, 1L, 7L, 2L, 6L, 4L, 5L, 1L, 3L, 8L, 5L, 2L,4L, 3L, 1L, 7L, 6L, 8L, 6L, 2L, 8L, 3L, 1L, 7L, 5L, 4L, 2L, 3L, 
6L, 5L, 8L, 4L, 1L, 7L, 4L, 2L, 8L, 3L, 5L, 1L, 6L, 7L, 3L, 6L,7L, 4L, 8L, 1L, 2L, 5L, 3L, 1L, 6L, 5L, 2L, 8L, 7L, 4L, 3L, 6L, 
4L, 8L, 1L, 7L, 2L, 5L, 2L, 5L, 1L, 7L, 3L, 8L, 6L, 4L, 8L, 2L, 7L, 1L, 3L, 6L, 5L, 4L, 7L, 2L, 1L, 3L, 6L, 4L, 5L, 8L, 2L, 4L, 
7L, 3L, 8L, 5L, 1L, 6L, 3L, 7L, 2L, 5L, 6L, 1L, 4L, 8L, 6L, 8L, 7L, 3L, 2L, 1L, 5L, 4L, 5L, 4L, 8L, 2L, 1L, 6L, 3L, 7L, 3L, 8L, 
2L, 6L, 1L, 4L, 5L, 7L, 3L, 6L, 8L, 7L, 4L, 2L, 1L, 5L, 3L, 8L, 5L, 1L, 7L, 4L, 6L, 2L, 16L, 10L, 14L, 15L, 13L, 12L, 11L, 9L, 
13L, 12L, 10L, 9L, 15L, 14L, 16L, 11L, 15L, 13L, 9L, 10L, 12L, 16L, 14L, 11L, 11L, 12L, 14L, 16L, 9L, 10L, 15L, 13L, 13L, 10L, 
14L, 12L, 16L, 11L, 9L, 15L, 14L, 15L, 9L, 13L, 10L, 11L, 12L, 16L, 13L, 15L, 9L, 12L, 11L, 16L, 14L, 10L, 10L, 11L, 14L, 12L, 
16L, 13L, 9L, 15L, 16L, 12L, 10L, 13L, 11L, 15L, 14L, 9L, 10L, 15L, 13L, 12L, 9L, 14L, 11L, 16L, 14L, 11L, 10L, 16L, 9L, 12L, 
13L, 15L, 9L, 16L, 14L, 13L, 10L, 15L, 12L, 11L, 14L, 11L, 16L,15L, 9L, 13L, 10L, 12L, 11L, 13L, 10L, 15L, 12L, 14L, 9L, 16L, 
13L, 16L, 10L, 11L, 9L, 15L, 12L, 14L, 16L, 11L, 13L, 15L, 14L, 9L, 10L, 12L, 16L, 9L, 12L, 11L, 15L, 14L, 10L, 13L, 13L, 16L, 
9L, 15L, 10L, 14L, 11L, 12L, 9L, 10L, 15L, 12L, 14L, 11L, 16L, 13L, 11L, 15L, 9L, 12L, 13L, 16L, 14L, 10L, 10L, 15L, 11L, 14L, 
9L, 13L, 16L, 12L, 18L, 19L, 17L, 20L, 21L, 22L, 19L, 17L, 20L,21L, 22L, 18L, 17L, 21L, 20L, 22L, 18L, 19L, 18L, 19L, 17L, 22L, 
21L, 20L, 17L, 18L, 19L, 22L, 20L, 21L, 22L, 18L, 17L, 21L, 20L,19L, 21L, 22L, 17L, 18L, 19L, 20L, 17L, 18L, 21L, 22L, 19L, 20L, 
18L, 19L, 20L, 17L, 22L, 21L, 22L, 19L, 17L, 18L, 21L, 20L, 21L,20L, 19L, 22L, 17L, 18L, 19L, 18L, 20L, 21L, 22L, 17L, 20L, 18L, 
21L, 17L, 22L, 19L, 18L, 19L, 17L, 22L, 20L, 21L, 22L, 17L, 21L, 19L, 18L, 20L, 20L, 17L, 21L, 18L, 22L, 19L, 18L, 20L, 19L, 17L, 
22L, 21L, 18L, 17L, 20L, 19L, 22L, 21L, 19L, 20L, 21L, 17L, 22L, 18L, 18L, 17L, 22L, 21L, 20L, 19L, 20L, 18L, 17L, 21L, 19L, 22L, 
23L, 27L, 29L, 26L, 28L, 24L, 25L, 24L, 29L, 27L, 26L, 25L, 28L, 23L, 27L, 24L, 29L, 26L, 23L, 25L, 28L, 24L, 28L, 27L, 29L, 25L, 
23L, 26L, 27L, 25L, 23L, 24L, 26L, 28L, 29L, 23L, 26L, 24L, 27L, 28L, 25L, 29L, 27L, 23L, 25L, 29L, 24L, 26L, 28L, 25L, 24L, 28L, 
29L, 23L, 27L, 26L, 26L, 23L, 24L, 29L, 27L, 28L, 25L, 29L, 27L, 25L, 28L, 23L, 24L, 26L, 25L, 28L, 27L, 24L, 26L, 29L, 23L, 23L, 
26L, 29L, 27L, 28L, 24L, 25L, 26L, 27L, 25L, 23L, 29L, 24L, 28L, 25L, 27L, 23L, 26L, 29L, 24L, 28L, 29L, 25L, 28L, 26L, 23L, 27L, 
24L, 28L, 23L, 27L, 29L, 25L, 24L, 26L, 27L, 26L, 28L, 29L, 23L, 25L, 24L, 24L, 28L, 27L, 25L, 29L, 26L, 23L, 27L, 28L, 26L, 23L, 
25L, 24L, 29L, 29L, 27L, 23L, 24L, 26L, 25L, 28L, 25L, 28L, 29L, 24L, 27L, 23L, 26L, 33L, 30L, 34L, 35L, 31L, 32L, 31L, 34L, 35L, 
32L, 30L, 33L, 31L, 34L, 32L, 35L, 33L, 30L, 32L, 34L, 30L, 33L, 35L, 31L, 35L, 30L, 31L, 32L, 33L, 34L, 34L, 33L, 35L, 30L, 31L, 
32L, 31L, 30L, 35L, 33L, 34L, 32L, 33L, 34L, 32L, 31L, 35L, 30L, 30L, 35L, 32L, 31L, 34L, 33L, 33L, 32L, 35L, 34L, 30L, 31L, 31L, 
32L, 33L, 30L, 35L, 34L, 33L, 34L, 30L, 35L, 32L, 31L, 35L, 32L, 34L, 33L, 31L, 30L, 33L, 30L, 34L, 35L, 32L, 31L, 32L, 33L, 31L, 
34L, 30L, 35L, 34L, 33L, 32L, 30L, 31L, 35L, 35L, 31L, 32L, 30L, 34L, 33L, 32L, 35L, 34L, 30L, 31L, 33L, 34L, 31L, 33L, 35L, 32L, 
30L, 30L, 33L, 34L, 32L, 35L, 31L, 30L, 35L, 34L, 32L, 33L, 31L, 41L, 36L, 39L, 38L, 40L, 37L, 42L, 42L, 37L, 39L, 40L, 36L, 38L, 
41L, 38L, 36L, 41L, 37L, 42L, 40L, 39L, 36L, 39L, 40L, 37L, 41L, 38L, 42L, 39L, 36L, 37L, 40L, 41L, 38L, 42L, 38L, 36L, 41L, 37L, 
42L, 39L, 40L, 36L, 37L, 42L, 39L, 38L, 40L, 41L, 38L, 41L, 36L, 37L, 40L, 39L, 42L, 39L, 41L, 37L, 36L, 42L, 38L, 40L, 42L, 40L, 
39L, 41L, 38L, 37L, 36L, 39L, 42L, 36L, 41L, 38L, 37L, 40L, 41L, 38L, 40L, 39L, 36L, 42L, 37L, 39L, 40L, 37L, 38L, 36L, 41L, 42L, 
39L, 38L, 36L, 40L, 41L, 42L, 37L, 40L, 41L, 37L, 42L, 38L, 39L, 36L, 39L, 40L, 42L, 36L, 38L, 37L, 41L, 40L, 36L, 41L, 37L, 42L, 
38L, 39L, 36L, 41L, 38L, 42L, 37L, 40L, 39L, 40L, 37L, 38L, 39L, 41L, 42L, 36L, 42L, 40L, 39L, 38L, 37L, 36L, 41L, 36L, 40L, 38L, 
37L, 42L, 41L, 39L), item = c(6L, 6L, 6L, 6L, 6L, 6L, 6L, 6L, 30L, 30L, 30L, 30L, 30L, 30L, 30L, 30L, 40L, 40L, 40L, 40L, 40L, 
40L, 40L, 40L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 25L, 25L, 25L, 25L, 25L, 25L, 25L, 25L, 26L, 26L, 26L, 26L, 26L, 26L, 26L, 
26L, 27L, 27L, 27L, 27L, 27L, 27L, 27L, 27L, 22L, 22L, 22L, 22L, 22L, 22L, 22L, 22L, 31L, 31L, 31L, 31L, 31L, 31L, 31L, 31L, 20L, 
20L, 20L, 20L, 20L, 20L, 20L, 20L, 23L, 23L, 23L, 23L, 23L, 23L, 23L, 23L, 16L, 16L, 16L, 16L, 16L, 16L, 16L, 16L, 14L, 14L, 14L, 
14L, 14L, 14L, 14L, 14L, 42L, 42L, 42L, 42L, 42L, 42L, 42L, 42L, 37L, 37L, 37L, 37L, 37L, 37L, 37L, 37L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 1L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 13L, 13L, 13L, 13L, 13L, 13L, 13L, 13L, 12L, 12L, 12L, 12L, 12L, 12L, 12L, 12L, 
3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 34L, 34L, 34L, 34L, 34L, 34L, 34L, 34L, 6L, 6L, 6L, 6L, 6L, 6L, 6L, 6L, 40L, 40L, 40L, 40L, 
40L, 40L, 40L, 40L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 11L, 11L, 11L, 11L, 11L, 11L, 11L, 11L, 26L, 26L, 26L, 26L, 26L, 26L, 
26L, 26L, 27L, 27L, 27L, 27L, 27L, 27L, 27L, 27L, 9L, 9L, 9L, 9L, 9L, 9L, 9L, 9L, 36L, 36L, 36L, 36L, 36L, 36L, 36L, 36L, 31L, 
31L, 31L, 31L, 31L, 31L, 31L, 31L, 20L, 20L, 20L, 20L, 20L, 20L,20L, 20L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 16L, 16L, 16L, 16L, 
16L, 16L, 16L, 16L, 14L, 14L, 14L, 14L, 14L, 14L, 14L, 14L, 21L,21L, 21L, 21L, 21L, 21L, 21L, 21L, 37L, 37L, 37L, 37L, 37L, 37L, 
37L, 37L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 33L, 33L, 33L, 33L, 33L, 33L, 33L, 33L, 13L, 13L, 13L, 13L, 13L, 13L, 13L, 13L, 3L, 
3L, 3L, 3L, 3L, 3L, 3L, 3L, 34L, 34L, 34L, 34L, 34L, 34L, 34L, 34L, 39L, 39L, 39L, 39L, 39L, 39L, 39L, 39L, 6L, 6L, 6L, 6L, 6L, 
6L, 10L, 10L, 10L, 10L, 10L, 10L, 11L, 11L, 11L, 11L, 11L,  11L, 19L, 19L, 19L, 19L, 19L, 19L, 27L, 27L, 27L, 27L, 27L, 27L,9L, 
9L, 9L, 9L, 9L, 9L, 36L, 36L, 36L, 36L, 36L, 36L, 17L, 17L, 17L, 17L, 17L, 17L, 20L, 20L, 20L, 20L, 20L, 20L, 2L, 2L, 2L, 2L, 2L,
2L, 38L, 38L, 38L, 38L, 38L, 38L, 32L, 32L, 32L, 32L, 32L, 32L, 14L, 14L, 14L, 14L, 14L, 14L, 21L, 21L, 21L, 21L, 21L, 
21L, 5L, 5L, 5L, 5L, 5L, 5L, 1L, 1L, 1L, 1L, 1L, 1L, 33L, 33L,33L, 33L, 33L, 33L, 29L, 29L, 29L, 29L, 29L, 29L, 34L, 34L, 34L, 
34L, 34L, 34L, 39L, 39L, 39L, 39L, 39L, 39L, 18L, 18L, 18L, 18L, 18L, 18L, 24L, 24L, 24L, 24L, 24L, 24L, 24L, 11L, 11L, 11L, 11L, 
11L, 11L, 11L, 19L, 19L, 19L, 19L, 19L, 19L, 19L, 7L, 7L, 7L,7L, 7L, 7L, 7L, 9L, 9L, 9L, 9L, 9L, 9L, 9L, 36L, 36L, 36L, 36L, 
36L, 36L, 36L, 17L, 17L, 17L, 17L, 17L, 17L, 17L, 41L, 41L, 41L, 41L, 41L, 41L, 41L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 38L, 38L, 38L, 
38L, 38L, 38L, 38L, 35L, 35L, 35L, 35L, 35L, 35L, 35L, 32L, 32L,32L, 32L, 32L, 32L, 32L, 21L, 21L, 21L, 21L, 21L, 21L, 21L, 5L, 
5L, 5L, 5L, 5L, 5L, 5L, 8L, 8L, 8L, 8L, 8L, 8L, 8L, 33L, 33L, 33L, 33L, 33L, 33L, 33L, 29L, 29L, 29L, 29L, 29L, 29L, 29L, 28L, 
28L, 28L, 28L, 28L, 28L, 28L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 39L, 39L, 39L, 39L, 39L, 39L, 39L, 18L, 18L, 18L, 18L, 18L, 18L, 18L, 
24L, 24L, 24L, 24L, 24L, 24L, 30L, 30L, 30L, 30L, 30L, 30L, 19L, 19L, 19L, 19L, 19L, 19L, 7L, 7L, 7L, 7L, 7L, 7L, 25L, 25L, 25L, 
25L, 25L, 25L, 17L, 17L, 17L, 17L, 17L, 17L, 41L, 41L, 41L, 41L, 41L, 41L, 22L, 22L, 22L, 22L, 22L, 22L, 38L, 38L, 38L, 38L, 38L, 
38L, 35L, 35L, 35L, 35L, 35L, 35L, 23L, 23L, 23L, 23L, 23L, 23L, 32L, 32L, 32L, 32L, 32L, 32L, 5L, 5L, 5L, 5L, 5L, 5L, 8L, 8L, 
8L, 8L, 8L, 8L, 42L, 42L, 42L, 42L, 42L, 42L, 29L, 29L, 29L, 29L, 29L, 29L, 28L, 28L, 28L, 28L, 28L, 28L, 4L, 4L, 4L, 4L, 
4L, 4L, 15L, 15L, 15L, 15L, 15L, 15L, 12L, 12L, 12L, 12L, 12L,12L, 18L, 18L, 18L, 18L, 18L, 18L, 24L, 24L, 24L, 24L, 24L, 24L, 
24L, 30L, 30L, 30L, 30L, 30L, 30L, 30L, 40L, 40L, 40L, 40L, 40L, 40L, 40L, 7L, 7L, 7L, 7L, 7L, 7L, 7L, 25L, 25L, 25L, 25L, 25L, 
25L, 25L, 26L, 26L, 26L, 26L, 26L, 26L, 26L, 41L, 41L, 41L, 41L, 41L, 41L, 41L, 22L, 22L, 22L, 22L, 22L, 22L, 22L, 31L, 31L, 31L, 
31L, 31L, 31L, 31L, 35L, 35L, 35L, 35L, 35L, 35L, 35L, 23L, 23L, 23L, 23L, 23L, 23L, 23L, 16L, 16L, 16L, 16L, 16L, 16L, 16L, 8L, 
8L, 8L, 8L, 8L, 8L, 8L, 42L, 42L, 42L, 42L, 42L, 42L, 42L, 37L, 37L, 37L, 37L, 37L, 37L, 37L, 28L, 28L, 28L, 28L, 28L, 28L, 28L, 
4L, 4L, 4L, 4L, 4L, 4L, 4L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 13L, 13L, 13L, 13L, 13L, 13L, 13L, 12L, 12L, 12L, 12L, 12L, 12L, 
12L, 3L, 3L, 3L, 3L, 3L, 3L, 3L)), .Names = c("N", "NS", "NI", "zero", "rt", "cond1", "cond2", "subject", "item"))


#fit
weibull_fit <-stan(model_code = weibull_code, data = dat, iter = 1000, chains = 4)
